function buCompare(){document.querySelectorAll(".brxe-bu-atcomp").forEach(function(e){var t=JSON.parse(e.getAttribute("data-comp-config"))||!1;t&&t.content&&tippy(e,{appendTo:e,content:"add"==t.action?t.content:t.addedContent,maxWidth:"none",interactive:!0,animation:t.animation,placement:t.placement,arrow:!0}),e.addEventListener("click",doCompare)}),document.querySelectorAll(".remove-compare-item").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let o=t.closest(".brxe-loop-builder-on")||!1,c=t.getAttribute("data-item-id"),n=t.getAttribute("data-post-type");bricksQuerySelectorAll(o,".bu-compare-content-of--"+c).forEach(function(e){e.classList.add("removing")}),fetch(bricksData.ajaxUrl.toString(),{method:"POST",body:"action=bu_delete_compare_item&security="+interactionParams.compare_nonce+"&postId="+c+"&postType="+n,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),bricksQuerySelectorAll(o,".bu-compare-content-of--"+c).forEach(function(e){e.classList.remove("removing")}),e;return e.json()}).then(function(t){t.success?(bricksQuerySelectorAll(o,".bu-compare-content-of--"+c).forEach(function(e){e.classList.add("removed")}),document.addEventListener("transitionend",function(){let e=".bu-comp-counter-btn--"+n+" .bu-comp-counter";document.querySelector(e)&&document.querySelectorAll(e).forEach(e=>{e.innerText=t.count,e.classList.contains(".hide-empty-comp-counter")&&(0<t.count?e.classList.remove("bu-comp-counter-hide-counter"):e.classList.add("bu-comp-counter-hide-counter"))}),bricksQuerySelectorAll(o,".bu-compare-content-of--"+c).forEach(function(e){e.remove()}),t.count<=0&&(o.closest(".brxe-bu-compare-items").remove(),window.location.reload())})):bricksQuerySelectorAll(o,".bu-compare-content-of--"+c).forEach(function(e){e.classList.remove("removing")})})})}),jQuery(".bu-compare-table-arrow").on("click",function(){var e=jQuery(this),t=e.parent().find(".bu-compare-table-wrapper"),o=t.find("tbody").find("tr:last-child td:last-child").outerWidth();"right"==e.data("side")?(e=o+t.scrollLeft(),t.animate({scrollLeft:e})):(e=o-t.scrollLeft(),t.animate({scrollLeft:-e}))})}function doCompare(e){e.preventDefault();let t=e.currentTarget,n=t.querySelector(".compare-action");(config=JSON.parse(t.getAttribute("data-comp-config"))||!1)&&(n.classList.add("adding"),fetch(bricksData.ajaxUrl.toString(),{method:"POST",body:"action=bu_update_compare_items&security="+interactionParams.compare_nonce+"&cookieKey="+config.cookie_key+"&compaction="+config.action+"&productId="+config.product+"&postType="+config.postType+"&notice="+(config.notify||0),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),n.classList.remove("adding"),e;return e.json()}).then(function(c){if(c.success){n.classList.remove("adding");let e=document.querySelectorAll(".bu-comp-counter-btn--"+config.postType+" .bu-comp-counter")||!1,t=document.querySelectorAll(".hide-empty-comp-counter")||!1,o=document.querySelectorAll(".bu-comp-hide-counter-btn--"+config.postType)||!1;"add"==config.action?(document.querySelectorAll(".compare-item-"+config.product).forEach(e=>{e.classList.add("added","action-delete"),e.classList.remove("action-add");const t=e.querySelector(".compare-text")||!1;config.removeText&&t&&(t.innerText=config.removeText),config.action="delete",e.closest(".brxe-bu-atcomp").setAttribute("data-comp-config",JSON.stringify(config))}),config.notify&&Notify(c.notice,null,null,"info")):"delete"==config.action&&document.querySelectorAll(".compare-item-"+config.product).forEach(e=>{e.classList.remove("added","action-delete"),e.classList.add("action-add");const t=e.querySelector(".compare-text")||!1;config.addText&&t&&(t.innerText=config.addText),config.action="add",e.closest(".brxe-bu-atcomp").setAttribute("data-comp-config",JSON.stringify(config))}),e&&e.forEach(e=>{e.innerText=c.count}),t&&t.forEach(e=>{0<c.count?e.classList.remove("bu-comp-counter-hide-counter"):e.classList.add("bu-comp-counter-hide-counter")}),o&&o.forEach(e=>{0<c.count?e.classList.remove("bu-comp-hide-btn"):e.classList.add("bu-comp-hide-btn")}),document.dispatchEvent(new Event("bu_update_compare"))}}))}document.addEventListener("DOMContentLoaded",e=>{bricksIsFrontend&&(buCompare(),window.buCompare=buCompare,window.WP_Grid_Builder&&WP_Grid_Builder.on("init",function(e){e.facets.on("appended",function(e){buCompare()})}))}),document.addEventListener("bricks/ajax/end",function(e){buCompare()}),document.addEventListener("bricks/ajax/query_result/displayed",function(e){buCompare()}),document.addEventListener("buAjaxSearchComplete",function(e){buCompare()}),document.addEventListener("buAfterGridTable",function(){setTimeout(()=>{buCompare()},100)});