function fancyDropdown(){document.querySelectorAll(".bu-as-cat").forEach(e=>{let o=e.querySelector(".bu-as-cat-dropdown")||!1,a=e.querySelector("input"),r=e.querySelector("a.trigger-terms-dd")||!1;function l(){o.classList.remove("bu-as-dd-opened"),r.classList.remove("arrow-up")}o&&(document.addEventListener("click",function(e){let t=e.target;if(o.classList.contains("bu-as-dd-opened")&&!t.closest(".bu-as-cat"))return l(),!1}),r.addEventListener("click",function(e){return e.preventDefault(),o.classList.contains("bu-as-dd-opened")?l():(o.classList.add("bu-as-dd-opened"),r.classList.add("arrow-up")),!1}),o.querySelectorAll("a").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=e.target,s=t.getAttribute("data-val"),i=t.innerText,n=t.closest(".bu-as-cat-list").querySelector(".current-item")||!1;0!=s?o.querySelector("ul:not(.children) > li:first-child").style.display="block":0==s&&(o.querySelector("ul:not(.children) > li:first-child").style.display="none"),n&&n.classList.remove("current-item"),t.closest("li").classList.add("current-item"),r.querySelector("span").innerText=i,a.value=s,a.dispatchEvent(new Event("term_selected")),l()})}))})}function buAjaxSearch(){void 0!==jQuery.fn.devbridgeAutocomplete&&document.querySelectorAll(".brxe-bu-ajax-search").forEach(s=>{let i=JSON.parse(s.getAttribute("data-buas-config")),t=s.querySelector(".search-form"),n=jQuery(t.querySelector(".s")),o=s.querySelector(".bu-as-result-content"),e=s.querySelector("a.trigger-terms-dd")||!1;resetBtn=s.querySelector(".search-reset-button")||!1,serviceUrl=bricksData.ajaxUrl.toString()+"?action=bu_ajax_search&security="+interactionParams.atc_nonce,i.template&&(serviceUrl+="&postType="+i.postType,i.template.post&&(serviceUrl+="&posts="+i.template.post.join("|")),i.template.term&&(serviceUrl+="&terms="+i.template.term.join("|")),i.relation&&(serviceUrl+="&meta_relation="+i.relation),n.on("focus keydown",function(){if(!jQuery(this).hasClass("bu-as-inited")){if(n.devbridgeAutocomplete({serviceUrl:serviceUrl,appendTo:jQuery(o),params:{meta_query:i.meta_query||""},minChars:3,zIndex:10,dataType:"JSON",type:"POST",onSelect:function(e){void 0!==e&&0<e.query.length&&n.val(e.query)},onHide:function(){o.closest(".bu-as-result-wrapper").classList.remove("result-opened")},onSearchStart:function(){s.classList.add("searching")},beforeRender:function(e){jQuery(e).removeAttr("style")},onSearchComplete:function(){s.classList.remove("searching"),resetBtn&&resetBtn.classList.add("show"),"no"!==i.viewAllBtn&&document.querySelectorAll(i.viewAllBtn).forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),t.submit()})}),document.dispatchEvent(new Event("buAjaxSearchComplete"))},formatResult:function(e,t){(t="&"===t?"&#038;":t).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");let s="";return e.value&&(s=e.value),o.closest(".bu-as-result-wrapper").classList.add("result-opened"),s}}),i.hasCat&&jQuery(s).find('[name="'+i.taxonomy+'"]').length){let e=jQuery(s).find('[name="'+i.taxonomy+'"]'),t=n.devbridgeAutocomplete();e[0].addEventListener("term_selected",function(){0!=this.value&&""!==this.value?t.setOptions({serviceUrl:serviceUrl+"&taxonomy="+i.taxonomy+"&term="+this.value}):t.setOptions({serviceUrl:serviceUrl}),t.hide(),t.onValueChange()})}jQuery(this).addClass("bu-as-inited")}}),jQuery(document).on("click",function(e){e=e.target;jQuery(e).is(".bu-as-result-wrapper")||jQuery(e).parents().is(".brxe-bu-ajax-search")||n.devbridgeAutocomplete("hide")}),e&&e.addEventListener("click",function(e){n.devbridgeAutocomplete("hide")}),resetBtn&&resetBtn.addEventListener("click",function(e){n.val(""),n.devbridgeAutocomplete("hide"),n.devbridgeAutocomplete("clear"),resetBtn.classList.remove("show")}),jQuery(o).on("click scroll",function(e){e.stopPropagation(),jQuery(this).find(".autocomplete-suggestions").show()}))})}document.addEventListener("DOMContentLoaded",fancyDropdown),document.addEventListener("DOMContentLoaded",buAjaxSearch),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"function"==typeof require?e(require("jquery")):e(jQuery)}(function(h){"use strict";var s={escapeRegExChars:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}},e=h.noop;function o(e,t){this.element=e,this.el=h(e),this.suggestions=[],this.badQueries=[],this.selectedIndex=-1,this.currentValue=this.element.value,this.timeoutId=null,this.cachedResponse={},this.onChangeTimeout=null,this.onChange=null,this.isLocal=!1,this.suggestionsContainer=null,this.noSuggestionsContainer=null,this.options=h.extend(!0,{},o.defaults,t),this.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},this.hint=null,this.hintValue="",this.selection=null,this.initialize(),this.setOptions(t)}o.utils=s,(h.Autocomplete=o).defaults={ajaxSettings:{},autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,onHint:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:function(e,t){if(!t)return e.value;t="("+s.escapeRegExChars(t)+")";return e.value.replace(new RegExp(t,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},formatGroup:function(e,t){return'<div class="autocomplete-group">'+t+"</div>"},delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:e,onSearchComplete:e,onSearchError:e,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,s){return-1!==e.value.toLowerCase().indexOf(s)},paramName:"query",transformResult:function(e){return"string"==typeof e?h.parseJSON(e):e},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1},o.prototype={initialize:function(){var e,t=this,s="."+t.classes.suggestion,i=t.classes.selected,n=t.options;t.element.setAttribute("autocomplete","off"),t.noSuggestionsContainer=h('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),t.suggestionsContainer=o.utils.createNode(n.containerClass),(e=h(t.suggestionsContainer)).appendTo(n.appendTo||"body"),"auto"!==n.width&&e.css("width",n.width),e.on("mouseover.autocomplete",s,function(){t.activate(h(this).data("index")),t.select(h(this).data("index"))}),e.on("mouseout.autocomplete",function(){t.selectedIndex=-1,e.children("."+i).removeClass(i)}),e.on("click.autocomplete",s,function(){t.select(h(this).data("index"))}),e.on("click.autocomplete",function(){clearTimeout(t.blurTimeoutId)}),t.fixPositionCapture=function(){t.visible&&t.fixPosition()},h(window).on("resize.autocomplete",t.fixPositionCapture),t.el.on("keydown.autocomplete",function(e){t.onKeyPress(e)}),t.el.on("keyup.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("blur.autocomplete",function(){t.onBlur()}),t.el.on("focus.autocomplete",function(){t.onFocus()}),t.el.on("change.autocomplete",function(e){t.onKeyUp(e)}),t.el.on("input.autocomplete",function(e){t.onKeyUp(e)})},onFocus:function(){this.disabled||(this.fixPosition(),this.el.val().length>=this.options.minChars&&this.onValueChange())},onBlur:function(){var e=this,t=e.options,s=e.el.val(),i=e.getQuery(s);e.blurTimeoutId=setTimeout(function(){e.hide(),e.selection&&e.currentValue!==i&&(t.onInvalidateSelection||h.noop).call(e.element)},200)},abortAjax:function(){this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null)},setOptions:function(e){e=h.extend({},this.options,e);this.isLocal=Array.isArray(e.lookup),this.isLocal&&(e.lookup=this.verifySuggestionsFormat(e.lookup)),e.orientation=this.validateOrientation(e.orientation,"bottom"),h(this.suggestionsContainer).css({"max-height":e.maxHeight+"px",width:e.width+"px","z-index":e.zIndex}),this.options=e},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){this.disabled=!0,clearTimeout(this.onChangeTimeout),this.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var e,t,s,i,n,o,a,r,l=h(this.suggestionsContainer),u=l.parent().get(0);u!==document.body&&!this.options.forceFixPosition||(o=this.options.orientation,e=l.outerHeight(),t=this.el.outerHeight(),s={top:(a=this.el.offset()).top,left:a.left},"auto"===o&&(r=h(window).height(),i=-(n=h(window).scrollTop())+a.top-e,n=n+r-(a.top+t+e),o=Math.max(i,n)===i?"top":"bottom"),s.top+="top"===o?-e:t,u!==document.body&&(r=l.css("opacity"),this.visible||l.css("opacity",0).show(),a=l.offsetParent().offset(),s.top-=a.top,s.top+=u.scrollTop,s.left-=a.left,this.visible||l.css("opacity",r).hide()),"auto"===this.options.width&&(s.width=this.el.outerWidth()+"px"),l.css(s))},isCursorAtEnd:function(){var e=this.el.val().length,t=this.element.selectionStart;return"number"==typeof t?t===e:!document.selection||((t=document.selection.createRange()).moveStart("character",-e),e===t.text.length)},onKeyPress:function(e){if(this.disabled||this.visible||40!==e.which||!this.currentValue){if(!this.disabled&&this.visible){switch(e.which){case 27:this.el.val(this.currentValue),this.hide();break;case 39:if(this.hint&&this.options.onHint&&this.isCursorAtEnd()){this.selectHint();break}return;case 9:if(this.hint&&this.options.onHint)return void this.selectHint();if(-1===this.selectedIndex)return void this.hide();if(this.select(this.selectedIndex),!1===this.options.tabDisabled)return;break;case 13:if(-1===this.selectedIndex)return void this.hide();this.select(this.selectedIndex);break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else this.suggest()},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case 38:case 40:return}clearTimeout(t.onChangeTimeout),t.currentValue!==t.el.val()&&(t.findBestHint(),0<t.options.deferRequestBy?t.onChangeTimeout=setTimeout(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var e,t,s;this.ignoreValueChange?this.ignoreValueChange=!1:(e=this.options,t=this.el.val(),s=this.getQuery(t),this.selection&&this.currentValue!==s&&(this.selection=null,(e.onInvalidateSelection||h.noop).call(this.element)),clearTimeout(this.onChangeTimeout),this.currentValue=t,this.selectedIndex=-1,e.triggerSelectOnValidInput&&this.isExactMatch(s)?this.select(0):s.length<e.minChars?this.hide():this.getSuggestions(s))},isExactMatch:function(e){var t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery:function(e){var t=this.options.delimiter;return t?(t=e.split(t),h.trim(t[t.length-1])):e},getSuggestionsLocal:function(t){var e=this.options,s=t.toLowerCase(),i=e.lookupFilter,n=parseInt(e.lookupLimit,10),e={suggestions:h.grep(e.lookup,function(e){return i(e,t,s)})};return n&&e.suggestions.length>n&&(e.suggestions=e.suggestions.slice(0,n)),e},getSuggestions:function(i){var e,t,s,n=this,o=n.options,a=o.serviceUrl;o.params[o.paramName]=i,!1!==o.onSearchStart.call(n.element,o.params)&&(e=o.ignoreParams?null:o.params,h.isFunction(o.lookup)?o.lookup(i,function(e){n.suggestions=e.suggestions,n.suggest(),o.onSearchComplete.call(n.element,i,e.suggestions)}):(s=n.isLocal?n.getSuggestionsLocal(i):(h.isFunction(a)&&(a=a.call(n.element,i)),t=a+"?"+h.param(e||{}),n.cachedResponse[t]))&&Array.isArray(s.suggestions)?(n.suggestions=s.suggestions,n.suggest(),o.onSearchComplete.call(n.element,i,s.suggestions)):n.isBadQuery(i)?o.onSearchComplete.call(n.element,i,[]):(n.abortAjax(),s={url:a,data:e,type:o.type,dataType:o.dataType},h.extend(s,o.ajaxSettings),n.currentRequest=h.ajax(s).done(function(e){n.currentRequest=null,e=o.transformResult(e,i),n.processResponse(e,i,t),o.onSearchComplete.call(n.element,i,e.suggestions)}).fail(function(e,t,s){o.onSearchError.call(n.element,i,e,t,s)})))},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,s=t.length;s--;)if(0===e.indexOf(t[s]))return!0;return!1},hide:function(){var e=h(this.suggestionsContainer);h.isFunction(this.options.onHide)&&this.visible&&this.options.onHide.call(this.element,e),this.visible=!1,this.selectedIndex=-1,clearTimeout(this.onChangeTimeout),h(this.suggestionsContainer).hide(),this.onHint(null)},suggest:function(){var i,n,o,a,r,l,e,t,s,u,c;this.suggestions.length?(n=this.options,o=n.groupBy,a=n.formatResult,r=this.getQuery(this.currentValue),l=this.classes.suggestion,e=this.classes.selected,t=h(this.suggestionsContainer),s=h(this.noSuggestionsContainer),u=n.beforeRender,c="",n.triggerSelectOnValidInput&&this.isExactMatch(r)?this.select(0):(h.each(this.suggestions,function(e,t){var s;o&&(c+=(s=t.data[o],i===s?"":(i=s,n.formatGroup(t,i)))),c+='<div class="'+l+'" data-index="'+e+'">'+a(t,r,e)+"</div>"}),this.adjustContainerWidth(),s.detach(),t.html(c.replace(/\"{/g,"'{").replace(/\}"/g,"}'")),h.isFunction(u)&&u.call(this.element,t,this.suggestions),this.fixPosition(),t.show(),n.autoSelectFirst&&(this.selectedIndex=0,t.scrollTop(0),t.children("."+l).first().addClass(e)),this.visible=!0,this.findBestHint())):this.options.showNoSuggestionNotice?this.noSuggestions():this.hide()},noSuggestions:function(){var e=this.options.beforeRender,t=h(this.suggestionsContainer),s=h(this.noSuggestionsContainer);this.adjustContainerWidth(),s.detach(),t.empty(),t.append(s),h.isFunction(e)&&e.call(this.element,t,this.suggestions),this.fixPosition(),t.show(),this.visible=!0},adjustContainerWidth:function(){var e,t=this.options,s=h(this.suggestionsContainer);"auto"===t.width?(e=this.el.outerWidth(),s.css("width",0<e?e:300)):"flex"===t.width&&s.css("width","")},findBestHint:function(){var i=this.el.val().toLowerCase(),n=null;i&&(h.each(this.suggestions,function(e,t){var s=0===t.value.toLowerCase().indexOf(i);return s&&(n=t),!s}),this.onHint(n))},onHint:function(e){var t=this.options.onHint,s="";e&&(s=this.currentValue+e.value.substr(this.currentValue.length)),this.hintValue!==s&&(this.hintValue=s,this.hint=e,h.isFunction(t)&&t.call(this.element,s))},verifySuggestionsFormat:function(e){return e.length&&"string"==typeof e[0]?h.map(e,function(e){return{value:e,data:null}}):e},validateOrientation:function(e,t){return e=h.trim(e||"").toLowerCase(),e=-1===h.inArray(e,["auto","bottom","top"])?t:e},processResponse:function(e,t,s){var i=this.options;e.suggestions=this.verifySuggestionsFormat(e.suggestions),i.noCache||(this.cachedResponse[s]=e,i.preventBadQueries&&!e.suggestions.length&&this.badQueries.push(t)),t===this.getQuery(this.currentValue)&&(this.suggestions=e.suggestions,this.suggest())},activate:function(e){var t=this.classes.selected,s=h(this.suggestionsContainer),i=s.find("."+this.classes.suggestion);return s.find("."+t).removeClass(t),this.selectedIndex=e,-1!==this.selectedIndex&&i.length>this.selectedIndex?(s=i.get(this.selectedIndex),h(s).addClass(t),s):null},selectHint:function(){var e=h.inArray(this.hint,this.suggestions);this.select(e)},select:function(e){this.onSelect(e)},moveUp:function(){if(-1!==this.selectedIndex)return 0===this.selectedIndex?(h(this.suggestionsContainer).children("."+this.classes.suggestion).first().removeClass(this.classes.selected),this.selectedIndex=-1,this.ignoreValueChange=!1,this.el.val(this.currentValue),void this.findBestHint()):void this.adjustScroll(this.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(e){var t,s,i,n=this.activate(e);n&&(s=h(n).outerHeight(),n=n.offsetTop,i=(t=h(this.suggestionsContainer).scrollTop())+this.options.maxHeight-s,n<t?h(this.suggestionsContainer).scrollTop(n):i<n&&h(this.suggestionsContainer).scrollTop(n-this.options.maxHeight+s),this.options.preserveInput||(this.ignoreValueChange=!0,this.el.val(this.getValue(this.suggestions[e].value))),this.onHint(null))},onSelect:function(e){var t=this.options.onSelect,e=this.suggestions[e];this.currentValue===this.el.val()||this.options.preserveInput||this.el.val(this.currentValue),this.onHint(null),this.suggestions=[],this.selection=e,h.isFunction(t)&&t.call(this.element,e)},getValue:function(e){var t,s=this.options.delimiter;return!s||1===(s=(t=this.currentValue).split(s)).length?e:t.substr(0,t.length-s[s.length-1].length)+e},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),h(window).off("resize.autocomplete",this.fixPositionCapture),h(this.suggestionsContainer).remove()}},h.fn.devbridgeAutocomplete=function(s,i){return arguments.length?this.each(function(){var e=h(this),t=e.data("autocomplete");"string"==typeof s?t&&"function"==typeof t[s]&&t[s](i):(t&&t.dispose&&t.dispose(),t=new o(this,s),e.data("autocomplete",t))}):this.first().data("autocomplete")},h.fn.autocomplete||(h.fn.autocomplete=h.fn.devbridgeAutocomplete)});