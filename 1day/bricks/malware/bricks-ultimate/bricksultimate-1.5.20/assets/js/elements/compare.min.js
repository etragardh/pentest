function buCompare(){document.querySelectorAll(".brxe-bu-atcomp").forEach(function(e){var t=JSON.parse(e.getAttribute("data-comp-config"))||!1;t&&t.content&&tippy(e,{appendTo:e,content:"add"==t.action?t.content:t.addedContent,maxWidth:"none",interactive:!0,animation:t.animation,placement:t.placement,arrow:!0}),e.addEventListener("click",doCompare)}),document.querySelectorAll(".bu-mini-compare").forEach(e=>{hideCompContent(e)}),document.querySelectorAll(".remove-compare-item").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let o=t.closest(".brxe-loop-builder-on")||!1,n=t.getAttribute("data-item-id"),c=t.getAttribute("data-post-type");bricksQuerySelectorAll(o,".bu-compare-content-of--"+n).forEach(function(e){e.classList.add("removing")}),fetch(bricksData.ajaxUrl.toString(),{method:"POST",body:"action=bu_delete_compare_item&security="+interactionParams.compare_nonce+"&postId="+n+"&postType="+c,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),bricksQuerySelectorAll(o,".bu-compare-content-of--"+n).forEach(function(e){e.classList.remove("removing")}),e;return e.json()}).then(function(t){t.success?(bricksQuerySelectorAll(o,".bu-compare-content-of--"+n).forEach(function(e){e.classList.add("removed")}),document.dispatchEvent(new Event("bu_update_compare")),document.addEventListener("transitionend",function(){let e=".bu-comp-counter-btn--"+c+" .bu-comp-counter";document.querySelector(e)&&document.querySelectorAll(e).forEach(e=>{e.innerText=t.count,e.classList.contains(".hide-empty-comp-counter")&&(0<t.count?e.classList.remove("bu-comp-counter-hide-counter"):e.classList.add("bu-comp-counter-hide-counter"))}),bricksQuerySelectorAll(o,".bu-compare-content-of--"+n).forEach(function(e){e.remove()}),t.count<=0&&(o.closest(".brxe-bu-compare-items").remove(),window.location.reload())})):bricksQuerySelectorAll(o,".bu-compare-content-of--"+n).forEach(function(e){e.classList.remove("removing")})})})}),jQuery(".bu-compare-table-arrow").on("click",function(){var e=jQuery(this),t=e.parent().find(".bu-compare-table-wrapper"),o=t.find("tbody").find("tr:last-child td:last-child").outerWidth();"right"==e.data("side")?(e=o+t.scrollLeft(),t.animate({scrollLeft:e})):(e=o-t.scrollLeft(),t.animate({scrollLeft:-e}))})}function hideCompContent(e){var t=e.getAttribute("data-hide-content")||"no";if("no"!=t){let t=e.querySelectorAll(".brxe-loop-builder-on").length||0,o=e.getAttribute("data-content-selectors")||"no";if("no"!=o){let e=o.toString().split(",");e.forEach(function(e){null!=document.querySelector(e)&&(0<parseInt(t)?document.querySelector(e).classList.remove("screen-reader-text"):document.querySelector(e).classList.add("screen-reader-text"))})}}}function doCompare(e){e.preventDefault();let t=e.currentTarget,c=t.querySelector(".compare-action");(config=JSON.parse(t.getAttribute("data-comp-config"))||!1)&&(c.classList.add("adding"),fetch(bricksData.ajaxUrl.toString(),{method:"POST",body:"action=bu_update_compare_items&security="+interactionParams.compare_nonce+"&cookieKey="+config.cookie_key+"&compaction="+config.action+"&productId="+config.product+"&postType="+config.postType+"&notice="+(config.notify||0),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),c.classList.remove("adding"),e;return e.json()}).then(function(n){if(n.success){c.classList.remove("adding");let e=document.querySelectorAll(".bu-comp-counter-btn--"+config.postType+" .bu-comp-counter")||!1,t=document.querySelectorAll(".hide-empty-comp-counter")||!1,o=document.querySelectorAll(".bu-comp-hide-counter-btn--"+config.postType)||!1;"add"==config.action?(document.querySelectorAll(".compare-item-"+config.product).forEach(e=>{e.classList.add("added","action-delete"),e.classList.remove("action-add");const t=e.querySelector(".compare-text")||!1;config.removeText&&t&&(t.innerText=config.removeText),config.action="delete",e.closest(".brxe-bu-atcomp").setAttribute("data-comp-config",JSON.stringify(config))}),config.notify&&Notify(n.notice,null,null,"info")):"delete"==config.action&&document.querySelectorAll(".compare-item-"+config.product).forEach(e=>{e.classList.remove("added","action-delete"),e.classList.add("action-add");const t=e.querySelector(".compare-text")||!1;config.addText&&t&&(t.innerText=config.addText),config.action="add",e.closest(".brxe-bu-atcomp").setAttribute("data-comp-config",JSON.stringify(config))}),e&&e.forEach(e=>{e.innerText=n.count}),t&&t.forEach(e=>{0<n.count?e.classList.remove("bu-comp-counter-hide-counter"):e.classList.add("bu-comp-counter-hide-counter")}),o&&o.forEach(e=>{0<n.count?e.classList.remove("bu-comp-hide-btn"):e.classList.add("bu-comp-hide-btn")}),document.dispatchEvent(new Event("bu_update_compare"))}}))}document.addEventListener("DOMContentLoaded",e=>{bricksIsFrontend&&(buCompare(),window.buCompare=buCompare,window.WP_Grid_Builder&&WP_Grid_Builder.on("init",function(e){e.facets.on("appended",function(e){buCompare()})}))}),document.addEventListener("bricks/ajax/end",function(e){buCompare()}),document.addEventListener("bricks/ajax/query_result/displayed",function(e){buCompare()}),document.addEventListener("buAjaxSearchComplete",function(e){buCompare()}),document.addEventListener("buAfterGridTable",function(){setTimeout(()=>{buCompare()},100)}),document.addEventListener("bu_update_compare",function(){document.querySelectorAll(".bu-mini-compare").forEach(o=>{fetch(bricksData.ajaxUrl.toString(),{method:"POST",body:"action=bu_mini_compare&security="+interactionParams.compare_nonce+"&element="+o.getAttribute("data-element-id")+"&post="+o.getAttribute("data-post-id"),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(t){if(t.fragments){const e=Object.keys(t.fragments).map(e=>[e,t.fragments[e]]);e.forEach(function(t,e,o){document.querySelectorAll(t[0]).forEach(e=>{e.innerHTML=t[1]})}),o.setAttribute("data-comp-counter",o.querySelectorAll(".brxe-loop-builder-on").length),hideCompContent(o)}document.dispatchEvent(new Event("bu_update_mini_compare"))})})});