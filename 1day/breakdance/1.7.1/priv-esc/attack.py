#!/usr/bin/env python3

import requests, os
from helpers import *
import base64

breakdance_data = '{"tree_json_string":"{\"root\":{\"id\":1,\"data\":{\"type\":\"root\",\"properties\":{}},\"children\":[{\"id\":100,\"data\":{\"type\":\"EssentialElements\\\\Section\",\"properties\":null},\"children\":[{\"id\":101,\"data\":{\"type\":\"EssentialElements\\\\CodeBlock\",\"properties\":{\"content\":{\"content\":{\"php_code\":\"<?php echo \\\"this is a test\\\"; ?>\"}}}},\"children\":[],\"_parentId\":100}],\"_parentId\":1}]},\"_nextNodeId\":102,\"status\":\"exported\"}"}'

url = 'http://localhost/wp-json/wp/v2/posts'

params={
    "title":"en ny post",
    "content": "innehall",
    "slug":"test-post-4",
    "status":"publish",
    "categories":1
}

wordpress_user = 'emil' 
wordpress_password = 'kebabmacka' 
wordpress_credentials = wordpress_user + ':' + wordpress_password
wordpress_token = base64.b64encode(wordpress_credentials.encode())
wordpress_header = {'Authorization': 'Basic ' + wordpress_token.decode('utf-8')}

nonce = get_nonce('http://localhost/?breakdance=builder&id=13')
nonce_header={
    "X-WP-Nonce":nonce
}


if not os.path.exists('_cookies'):
    extract_cookies('http://localhost', 'emil', 'kebabmacka')

#res = requests.post(url, headers=wordpress_header, json=params)
#res = requests.post(url, cookies=load_cookies('_cookies'), json=params, headers=nonce_header)

"http://localhost/wp-json/wp/v2/posts/20?_locale=user"


print("Status:", res.status_code)
print(res.text)



