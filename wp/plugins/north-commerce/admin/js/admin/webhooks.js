/**
 * Webhooks
 * Javascript for the admin webhooks page
 * 
 * @since 0.1.20
 */
export class Webhooks {

    constructor() {
        this.setupEventListeners();
    }

    /**
     *      
     */
    setupEventListeners() {        
        
        const _this = this;

        document.querySelectorAll('.webhook-group__title').forEach(this.setInitialState);
        
        document.querySelectorAll('.webhook-group__title').forEach(function(titleDiv) {
            titleDiv.addEventListener('click', function() {
                _this.toggleGroup(titleDiv);
            });
        });

    }    

    setInitialState(titleDiv) {
        var eventsList = titleDiv.nextElementSibling;
        var svg = titleDiv.querySelector('svg');
    
        // If any checkbox in this group is checked, show the list
        var anyChecked = Array.from(eventsList.querySelectorAll('input[type="checkbox"]')).some(checkbox => checkbox.checked);
    
        if (anyChecked) {
            eventsList.style.display = 'flex';
            svg.style.transform = 'rotate(90deg)';
        } else {
            eventsList.style.display = 'none';
            svg.style.transform = '';
        }
    }
    
    toggleGroup(titleDiv) {
        var eventsList = titleDiv.nextElementSibling;
        var svg = titleDiv.querySelector('svg');
    
        if (eventsList.style.display !== 'flex') {
            eventsList.style.display = 'flex';
            svg.style.transform = 'rotate(90deg)';
        } else {
            eventsList.style.display = 'none';
            svg.style.transform = '';
        }
    }

}