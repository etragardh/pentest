<?php

defined( 'ABSPATH' ) || exit;

use NorthCommerce\Db\Collections\CouponDiscountTypes as DiscountTypes;

/**
 * Discount Type section
 *
 *
 * @package north-commerce/admin/templates/coupon/single
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.21
 * @version 0.1.24
 */

?>
<h3>
    <?php esc_html_e( 'Discount Type', 'north-commerce' ); ?>
</h3>
<?php

foreach ( $discount_types_list as $discount_type ) {
    ?>
    <label class="radio-container">
        <?php echo esc_html( $discount_type['name'] ); ?>
        <input
            type="radio"
            name="coupon_discount_type_id"
            id="<?php echo esc_attr( $discount_type['slug'] . '-discount-type' ); ?>"
            value="<?php echo esc_attr( $discount_type['id'] ); ?>"
            <?php checked( $discount_type['slug'], $coupon_discount_type['slug'] ); ?>
        >
        <span class="checkmark"></span>
    </label>
    <?php

    if ( DiscountTypes::freeShipping()->slug === $discount_type['slug'] ) {
        // skip optional container
        continue;
    }

    $is_active = $discount_type['slug'] === $coupon_discount_type['slug'];
    $class_active = $is_active ? ' active' : '';
    $discount_amount_value = $is_active ? $coupon_discount_amount : '';

    ?>
    <div class="optional-container width-limit <?php echo esc_attr( $discount_type['slug'] . '-discount-amount' ) . $class_active ?>">
        <label for="<?php echo esc_attr( $discount_type['slug'] . '-discount-amount' ); ?>">
            <?php esc_html_e( 'Discount value', 'north-commerce' ); ?>
        </label>
        <div class="input-wrapper">
            <input
                type="number"
                id="<?php echo esc_attr( $discount_type['slug'] . '-discount-amount' ); ?>"
                name="<?php echo esc_attr( 'coupon_' . $discount_type['slug'] . '_discount_amount' ); ?>"
                placeholder="0.00"
                min="0"
                <?php echo DiscountTypes::percent()->id === $discount_type['id'] ? 'max="100"' : ''; ?>
                step="0.01"
                value="<?php echo esc_attr( $discount_amount_value ); ?>"
            >
            <span class="input-suffix"><?php echo esc_html( $discount_type['suffix'] ); ?></span>
        </div>
    </div>
    <?php
}