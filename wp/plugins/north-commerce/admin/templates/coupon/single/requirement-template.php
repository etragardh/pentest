<?php

defined( 'ABSPATH' ) || exit;

use NorthCommerce\Db\Collections\CouponRequirements as Requirements;

/**
 * Requirement section
 *
 *
 * @package north-commerce/admin/templates/coupon/single
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.21
 * @version 0.1.24
 */

?>
<h3>
    <?php esc_html_e( 'Requirement', 'north-commerce' ); ?>
</h3>
<?php

foreach ( $requirements_list as $requirement ) {
    ?>
    <label class="radio-container">
        <?php echo esc_html( $requirement['name'] ); ?>
        <input
            type="radio"
            name="coupon_requirement_id"
            id="<?php echo esc_attr( $requirement['slug'] . '-requirement' ); ?>"
            value="<?php echo esc_attr( $requirement['id'] ); ?>"
            <?php checked( $requirement['slug'], $coupon_requirement['slug'] ); ?>
        >
        <span class="checkmark"></span>
    </label>
    <?php

    if ( Requirements::none()->slug === $requirement['slug'] ) {
        // skip optional container
        continue;
    }

    $is_active = $requirement['slug'] === $coupon_requirement['slug'];
    $class_active = $is_active ? ' active' : '';
    $requirement_amount_value = $is_active ? $coupon_requirement_amount : 0;
    $type_money = in_array( $requirement['slug'], [ 'minimum-purchase-amount' ] );

    ?>
    <div class="optional-container width-limit <?php echo esc_attr( $requirement['slug'] . '-requirement-amount' ) . $class_active ?>">
        <label for="<?php echo esc_attr( $requirement['slug'] . '-requirement' ); ?>">
            <?php esc_html_e( 'Requirement value', 'north-commerce' ); ?>
        </label>
        <div class="input-wrapper">
            <input
                type="number"
                id="<?php echo esc_attr( $requirement['slug'] . '-requirement' ); ?>"
                name="<?php echo esc_attr( 'coupon_' . $requirement['slug'] . '_requirement' ); ?>"
                placeholder="<?php echo esc_attr( $type_money ? '0.00' : '0' ); ?>"
                min="<?php echo esc_attr( $type_money ? '0.01' : '1' ); ?>"
                step="<?php echo esc_attr( $type_money ? '0.01' : '1' ); ?>"
                value="<?php echo esc_attr( $requirement_amount_value ); ?>"
            >
            <span class="input-suffix"><?php echo esc_html( $requirement['suffix'] ); ?></span>
        </div>
    </div>
    <?php
}
