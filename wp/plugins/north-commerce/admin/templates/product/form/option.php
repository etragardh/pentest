<?php

defined( 'ABSPATH' ) || exit;

/**
 * Single option template
 *
 * @author  North Commerce <hello@northplugins.com>
 * @package north-commerce/admin/templates
 * @since   0.1.12
 * @version 0.1.13
 */

$option_type_slug = $option['product_option_type']['slug'] ?? '';

?>
<div
	class="option <?php echo esc_attr( $class ?? '' ); ?>"
	data-id="<?php echo esc_attr( $option['id'] ?? '' ) ?>"
	data-option-type="<?php echo esc_attr( $option_type_slug ); ?>"
	>
    <div class="option__sort"></div>
    <div class="option__data">
        <div class="option__field option__field-half">
			<?php
			$this->template( 'label', 'product/form', [
				'label' => __( 'Option name', 'north-commerce' )
			] );

			?>
            <input
				type="text"
				class="option-name"
				value="<?php echo esc_attr( $option['name'] ?? '' ); ?>"
				>
		</div>

        <div class="option__field option__field-type option__field-half">
			<?php
			$this->template( 'label', 'product/form', [
				'label' => __( 'Option type', 'north-commerce' )
			] );

			?>
			<select
				class="option-select-type"
				data-minimum-results-for-search="Infinity"
				>
				<?php
				foreach ( $product_option_types as $type ) {
					?>
					<option
						value="<?php echo esc_attr( $type['slug'] ); ?>"
						data-id="<?php echo esc_attr( $type['id'] ); ?>"
						<?php selected( $option_type_slug, $type['slug'] ); ?>
						>
						<?php echo esc_html( $type['name'] ); ?>
					</option>
					<?php
				}
				?>
			</select>
		</div>

		<div class="option__field option__field-values">
			<?php
			$this->template( 'label', 'product/form', [
				'label' => __( 'Option value', 'north-commerce' )
			] );

			?>
			<div class="option__values">
				<?php
				$product_option_values = $option['product_option_values'] ?? [];

				foreach ( $product_option_values as $pov ) {
					if ( $pov['deleted'] ) {
						continue;
					}

					$this->template( 'option_value', 'product/form', [
						'option_type_slug' => $option_type_slug,
						'pov' => $pov
					] );
				}

				$this->template( 'option_value', 'product/form', [
					'pov' => [],
					'option_type_slug' => $option_type_slug,
					'class' => 'template'
				] );

				?>
				<input type="text" class="option-input">
				<?php

				$this->template( 'option_prompt', 'product/form', [
					'product_option_types' => $product_option_types,
					'option_type_slug' => $option_type_slug,
					'product_model' => $product_model
				] );

				?>
			</div>
			<?php

			$this->template( 'option_footer_actions', 'product/form' );

			?>
		</div>
	</div>

	<?php
	$this->template( 'option_actions', 'product/form' );
	?>
	<div class="option__overlay"></div>
</div>
