<?php
/**
 * Customer item template.
 *
 * @package north-commerce/admin/templates
 * @link    https://northcommerce.com/
 * @since   0.1.0
 * @version 0.1.11
 */

?>
<div
    class="customer"
    data-customer-id="<?php echo $customer['id'] ?>"
    data-customer-url="<?php echo admin_url( 'admin.php?page=north-commerce-customers&amp;action=edit&id=' . $customer['id'] ); ?>"
>
    <div class="customer__select result-col-1">
        <label for="customer-echo-id"></label>
        <input type="checkbox" name="customer-echo-id" id="customer-echo-id"/>
    </div>
    <div class="customer__info result-col-5">

        <a
            class="customer__name"
            href="<?php echo admin_url( 'admin.php?page=north-commerce-customers&amp;action=edit&id=' . $customer['id'] ); ?>"
        >
            <?php

            if ( ! $customer['first_name'] ) {
                echo $customer['email'];
            } else {
                echo $customer['first_name'] . ' ' . $customer['last_name'];
            }

            ?>
        </a>
        <?php
        if ( $customer['addresses'] ) {
            echo '<div class="customer__address">',
                $customer['addresses'][0]['city'] . ', ' . $customer['addresses'][0]['state'] . ' ' . $customer['addresses'][0]['country']['name'],
            '</div>';
        }
        ?>
    </div>
    <div class="customer__orders-count result-col-2">
		<?php
		echo count( $customer['orders'] ) . ' ' . ( count( $customer['orders'] ) > 1 ? 'Orders' : 'Order' )
		?>
    </div>
    <div class="customer__total-spent result-col-2">
        <?php

        $total_spent = 0;
        foreach ( $customer['orders'] as $order ) {
            $total_spent += $order['total'];
        }

        echo North_Commerce_Settings::formatted_price( $total_spent );

	  	?>
    </div>
    <div class="customer__type result-col-2">
        <div class="customer__type__display <?php echo 'customer__type__display--' . ( $customer_role['slug'] ?? '' ); ?>">
            <?php echo $customer['wp_user_id'] ? 'Member' : 'Customer' ?>
        </div>
    </div>
</div>
