<?php

$country_model = new \NorthCommerce\Models\CountryModel();
$countries = $country_model->list_all();

?>
<form
    class="admin-popup"
    data-form-type="<?php echo $type ?>"
    data-form-identity="shipping-address-form"
    data-shipping-address-id="<?php echo esc_attr( $current_address['id'] ?? '' ); ?>"
>
    <div class="admin-popup__header">
        <div class="admin-popup__left-side">
            <h3 class="integration-popup-name">Edit <?php echo $title ?> Address</h3>
            <div class="loader" style="display: none;"></div>
        </div>
        <a
            href="javascript:void(0);"
            class="admin-popup__close customer-popup-close"
            data-fancybox-close
        ></a>
    </div>
    <div class="admin-popup__body">
        <div class="admin-popup__notice"></div>
        <div class="admin-popup__content">
            <div class="admin-popup-field admin-popup-field_half">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="shipping_name">
                        <?php esc_html_e( 'First Name', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="shipping_name"
                        id="shipping_name"
                        value="<?php echo esc_attr( $current_address['first_name'] ?? '' ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_half">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="shipping_surname">
                        <?php esc_html_e( 'Last Name', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="shipping_surname"
                        id="shipping_surname"
                        value="<?php echo esc_attr( $current_address['last_name'] ?? '' ); ?>"
                    >
                </div>
            </div>
            <?php
            $address_line_1 = $current_address['addressline1'] ?? '';
            $address_line_2 = $current_address['addressline2'] ?? '';
            ?>
            <div class="admin-popup-field admin-popup-field_full">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="shipping_address">
                        <?php esc_html_e( 'Shipping Address', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="shipping_address"
                        id="shipping_address"
                        value="<?php echo esc_attr( $address_line_1 ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_full">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="shipping_address">
                        <?php esc_html_e( 'Shipping Address Line 2', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="shipping_address2"
                        id="shipping_address"
                        value="<?php echo esc_attr( $address_line_2 ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_full">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="city">
                        <?php esc_html_e( 'City', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="city"
                        id="city"
                        value="<?php echo esc_attr( $current_address['city'] ?? '' ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_half">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky"  for="state">
                        <?php esc_html_e( 'State', 'north-commerce' ); ?>
                    </label>
                    <input
                        type="text"
                        name="state"
                        id="state"
                        value="<?php echo esc_attr( $current_address['state'] ?? '' ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_half">
                <div class="admin-popup__field-wrapper">
                    <label class="admin-popup__label-sticky" for="zip"><?php esc_html_e( 'Zip Code', 'north-commerce' ); ?></label>
                    <input
                        type="text"
                        name="zip"
                        id="zip"
                        value="<?php echo esc_attr( $current_address['zipcode'] ?? '' ); ?>"
                    >
                </div>
            </div>
            <div class="admin-popup-field admin-popup-field_full">
                <div class="admin-popup__field-wrapper dropdown-arrow-container">
                    <?php
                    $customers_country_id = $current_address['country_id'] ?? '';
                    ?>
                    <label class="admin-popup__label-sticky" for="country">
                        <?php esc_html_e( 'Country', 'north-commerce' ); ?>
                    </label>
                    <select class="shipping-country-dropdown" data-shipping-country-selector>
                        <?php
                        foreach ( $countries as $country ) {
                            ?>
                            <option
                                name="country"
                                value="<?php echo esc_attr( $country['id'] ); ?>"
                                <?php echo ( $customers_country_id == $country['id'] ? 'selected' : '' ); ?>
                                data-shipping-country-id="<?php echo esc_attr( $country['id'] ) ?>"
                            >
                                <?php echo esc_html( $country['name'] ); ?>
                            </option>
                            <?php
                        }
                        ?>
                    </select>
                </div>
            </div>
        </div>
        <div class="admin-popup__actions">
            <a
                href="javascript:void(0);"
                class="admin-popup-cancel order-popup-cancel"
                data-fancybox-close
            >
                <span><?php esc_html_e( 'Cancel', 'north-commerce' ); ?></span>
            </a>
            <input
                type="submit"
                class="admin-popup-submit"
                value="Save"
            >
        </div>
    </div>
</form>