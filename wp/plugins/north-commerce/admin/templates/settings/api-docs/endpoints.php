<?php
/**
 * A PHP file for displaying the endpoints associated with this
 * table
 *
 * @since   0.1.10
 * @version 0.1.13
 */

$agent = North_Commerce_Db_Agent::instance();
$schema = $agent->schema();
$entity_name = $agent->tableToEntityName( $table_name );

?>
<h3>Routes</h3>
<div class="routes">
	<?php
	echo $this->template('route', 'settings/api-docs', [
		'verb' => 'GET',
		'uri' => "/$entity_name"
	] );

	echo $this->template('route', 'settings/api-docs', [
		'verb' => 'GET',
		'uri' => "/$entity_name/<id>"
	] );

	foreach ( $schema->getTables() as $child_table_name => $child_table_info ) {
		foreach ( $child_table_info['cols'] as $col_name => $col_info ) {
			if ( $col_info['type'] == 'REF' && $col_info['ref_table'] == $table_name ) {
				$child_entity_name = $agent->tableToEntityName( $child_table_name );

				echo $this->template( 'route', 'settings/api-docs', [
					'verb' => 'GET',
					'uri' => "/$entity_name/<id>/$child_entity_name"
				] );
			}
		}
	}

	echo $this->template( 'route', 'settings/api-docs', [
		'verb' => 'POST',
		'uri' => "/$entity_name"
	] );

	echo $this->template( 'route', 'settings/api-docs', [
		'verb' => 'POST',
		'uri' => "/$entity_name/<id>"
	] );

	?>
</div>
