<?php

use North_Commerce_Settings as Settings;

$active_image_name = Settings::get_company_logo_name();

$images = glob( __DIR__ . '/*.{jpg,jpeg,webp,png,gif}', GLOB_BRACE );

if ( ! empty( $filename )  ) {
    $images = array_reduce( $images, function ( $image, $current ) use ( $filename )  {
        if ( basename( $current ) === $filename  ) {
            $image = array( $current );
        }
        return $image ?? null;
    } );
}

foreach ( $images as $image_path ) {

    $image_name = basename( $image_path );
    $id = "company-logo-$image_name";

    echo '<input',
        ' id="' . $id . '"',
        ' type="radio"',
        ' name="company-logo-image"',
        ' value="' . $image_name . '"',
        checked( $image_name === $active_image_name, true, false ),
        '>';

    $logo_name = Settings::get_company_logo_name();

    if($logo_name) {

        echo '<label class="icon-option" for="' . $id . '">',
            '<img src="' . Settings::get_company_logo_url( $image_name ) . '">',
        '</label>';

    } else {

        echo '<label class="icon-option" for="add-company-logo">',
            '<span>Upload an image</span>',
        '</label>';
    }

}
