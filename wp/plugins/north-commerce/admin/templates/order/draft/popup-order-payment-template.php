<?php

defined( 'ABSPATH' ) || exit;

/**
 * Order payment modal
 *
 *
 * @package north-commerce/admin/templates/order/draft
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.24
 * @version 0.1.25
 */


$render_stripe_optional_contaier = function () {
	$is_connected = ( new North_Commerce_Stripe() )->is_connected();
	$extra_class = $is_connected ? 'container' : 'notice';

	$card_element_placeholder = function () {
		?>
		<label class="label">
			<?php esc_html_e( 'Card', 'north-commerce' ); ?>
		</label>
		<div id="stripe-element" class="stripe-element"></div>
		<?php
	};

	$notice = function () {
		printf(
			'Please connect Stripe in the <a href="%s" target="_blank">integrations area</a>.',
			admin_url( 'admin.php?page=north-commerce-integration' ),
		);
	};

    ?>
    <div
		class="optional-container stripe-<?php echo esc_attr( $extra_class ); ?>"
		data-nc-type="stripe"
	>
		<?php
		$is_connected
			? $card_element_placeholder()
			: $notice();
		?>
    </div>
    <?php
};

?>
<div class="nc-custom-popup" id="order-payment-modal">
	<div class="popup-order-payment admin-popup nc-custom-popup__window">
		<div class="admin-popup__header">
			<div class="admin-popup__left-side">
				<h3 class="integration-popup-name">
					<?php esc_html_e( 'Pay with credit card', 'north-commerce' ); ?>
				</h3>
				<div class="loader"></div>
			</div>
			<a
				href="javascript:void(0);"
				class="admin-popup__close"
				data-nc-custom-popup-close
			></a>
		</div>

		<div class="admin-popup__body">
			<div class="admin-popup__notice"></div>
			<div class="admin-popup__content">
				<div class="payment-options">
                    <label class="radio-container payment-radio new-stripe">
                        <input
                            type="radio"
                            class="payment__option"
                            name="payment_option"
                            value="stripe"
                        >
                        <span class="checkmark"></span>
                        <span class="option__name">
                            <?php esc_html_e( 'Use other card', 'north-commerce' ); ?>
                        </span>
                    </label>
                    <?php
					$render_stripe_optional_contaier();
					?>
				</div>
				<div class="errors"></div>

				<div class="admin-popup__actions">
					<a
						href="javascript:void(0);"
						class="btn btn--cancel admin-popup-cancel"
						data-nc-custom-popup-close
					>
						<?php esc_html_e( 'Cancel', 'north-commerce' ); ?>
					</a>
					<button
						type="button"
						class="btn btn--submit admin-popup-submit disabled"
                        data-nc-action="order-pay"
					>
						<?php esc_html_e( 'Pay', 'north-commerce' ); ?>
					</button>
				</div>
			</div>
		</div>
	</div>
</div>