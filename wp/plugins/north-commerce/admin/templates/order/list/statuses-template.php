<?php

defined( 'ABSPATH' ) || exit;

use NorthCommerce\Db\Collections\{
    OrderStatuses
};

/**
 * Orders statuses.
 *
 *
 * @package north-commerce/admin/templates/order
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.24
 * @version 0.1.25
 */

$temporarily_excluded_statuses = [
    OrderStatuses::outForDelivery(),
    OrderStatuses::delivered(),
    OrderStatuses::abandoned(),
];

$criteria = function() use ( $temporarily_excluded_statuses ) {
    foreach ( $temporarily_excluded_statuses as $status ) {
        $exclude[] = [ 'not', [ 'eq', 'id', $status->id ] ];
    }
    return [ 'and', $exclude ];
};

$order_statuses = $order_model->list_statuses( $criteria() );
$order_statuses = apply_filters( 'north-commerce/orders/statuses', $order_statuses );

?>
<div class="orders__status">
    <a
        href="javascript:void(0);"
        class="status__filter status__filter-order active"
        data-status-filter=""
    >
        <?php esc_html_e( 'All', 'north-commerce' ); ?>
        <span>
            <?php echo '(' . esc_html( $orders_total ) . ')'; ?>
        </span>
    </a>
    <?php

    foreach ( $order_statuses as $status ) {
        ?>
        <a
            href="javascript:void(0);"
            class="status__filter status__filter-order status__filter-order-<?php echo esc_attr( $status['slug'] ); ?>"
            data-status-filter="<?php echo esc_attr( $status['slug'] ); ?>"
        >
            <?php echo esc_html( $status['name'] ); ?>
            <span>
                <?php echo esc_html( '(' . $order_model->count_by_status( $status['slug'] ) . ')' ); ?>
            </span>
        </a>
        <?php
    }

    ?>
</div>