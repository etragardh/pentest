<?php
/**
 * Provide a admin area view for the plugin
 *
 * This file is used to markup the admin-facing aspects of the plugin.
 *
 * @package north-commerce/admin/templates/integration
 * @link    https://northcommerce.com/
 * @since   0.1.0
 * @version 0.1.4
 */

if ( ! isset( $integration_item ) ) {
    // Bailout.
    return;
}

$is_switchable = $integration_item['switchable'] ?? null;
if ( isset( $integration_item['test_mode'] ) ) {
    $integration_with_mode = 'service-mode';
    $mode = $integration_item['test_mode'] ? 'test' : 'live';
}

?>
<div
	class="service-item"
	data-integration_id="<?php echo esc_attr( $integration_item['id'] ); ?>"
	<?php echo isset( $integration_with_mode ) ? ' data-service-mode="true"' : ''; ?>
	>

	<div class="service-item__header">

		<div class="service-item__img">
			<img
				src="<?php echo esc_url( $integration_item['icon_src'] ); ?>"
				alt="<?php echo esc_attr( $integration_item['name'] ) . ' icon'; ?>"
				>
		</div>

		<div class="service-item__actions">
			<div class="service-item__settings">
				<a class="service-setting" href="#">
					<img src="<?php echo esc_url( NORTH_COMMERCE_PLUGIN_DIR_URL . 'admin/images/setting.png' ); ?>">
				</a>
			</div>

			<div class="switch">
				<?php

				$checked = $integration_item['enabled'];
				if ( $is_switchable && isset( $mode ) ) {
					$checked = 'live' === $mode;
				}

				?>
				<input
					type="checkbox"
					id="<?php echo esc_attr( $integration_item['id'] ); ?>"
					name="<?php echo esc_attr( $integration_item['id'] ); ?>"
					class="<?php echo $is_switchable && isset( $mode ) ? 'switch-service-mode' : 'switch-service'; ?>"
					data-mode="<?php echo $mode ?? ''; ?>"
					tabindex="0"
					<?php checked( $checked ); ?>
					>

				<label
					class="switch-service-label<?php echo $is_switchable && isset( $mode ) ? ' switch-service-label__mode' : ''; ?>"
					for="<?php echo esc_attr( $integration_item['id'] ); ?>"
					>
					<span class="switch-dot"></span>
				</label>

			</div>

		</div>
	</div>

	<div class="service-item__body">

		<div class="service-item__title">

			<div class="title__wrapper">

				<h3>
					<?php echo esc_html( $integration_item['name'] ); ?>
				</h3>
				<?php
				$extra_class = ! $is_switchable ? ' hidden-label' : '';
				echo '<span',
					' class="service-mode-label' . $extra_class . '"',
					' data-service-mode="' . ( $mode ?? '' ) . '"',
					' data-label-test="' . esc_html__( 'Test', 'north-commerce' ) . '"',
					' data-label-live="' . esc_html__( 'Live', 'north-commerce' ) . '"',
					'>',
					isset( $mode ) && $integration_item['test_mode'] ? 'Test' : 'Live',
				'</span>';
				?>
			</div>

			<div class="loader"></div>

		</div>

		<p>
			<?php echo esc_html( $integration_item['description'] ); ?>
		</p>

	</div><?php // service-item__body ?>

</div>
