<?php
/**
 * Integraton placeholder template
 *
 *
 * @package north-commerce/admin/templates/integration
 * @link    https://northcommerce.com/
 * @since   0.1.1
 * @version 0.1.13
 */

if ( ! isset( $integration_item ) ) {
    // Bailout.
    return;
}

$plugin_file = $integration_item['addon_id'] . '/' . $integration_item['addon_id'] . '.php';
$activatable = file_exists( WP_PLUGIN_DIR . '/' . $integration_item['addon_id'] )
	&& current_user_can( 'activate_plugin', $plugin_file );

if ( $activatable ) {

    $button_href = add_query_arg(
        [
            'action' => 'activate',
            'plugin' => urlencode( $plugin_file ),
            'plugin_status' => 'all',
            '_wpnonce' => wp_create_nonce( 'activate-plugin_' . $plugin_file ),
        ],
        admin_url( 'plugins.php' )
    );

    $button_class = 'activate-now';
    $button_text = esc_html__( 'Activate', 'north-commerce' );

} else {

    $button_href = add_query_arg(
        [
            'action' => 'install_addon',
            'addon' => $integration_item['addon_id'],
            '_ajax_nonce' => wp_create_nonce( 'install-addon' ),
        ],
        admin_url( 'admin-ajax.php' )
    );

    $button_class = 'install-now';
    $button_text = esc_html__( 'Install Now', 'north-commerce' );

}

?>
<div class="service-item service-placeholder">
	<div class="service-item__header">
		<div class="service-item__img">
			<img src="<?php echo esc_url( $integration_item['icon_src'] ); ?>">
		</div>

		<div class="service-item__actions">
			<a
				class="action-button <?php echo $button_class; ?>"
				href="<?php echo esc_url( $button_href ); ?>"
				data-text-idle="<?php esc_attr_e( 'Install Now', 'north-commerce' ); ?>"
				data-text-installing="<?php esc_attr_e( 'Installing...', 'north-commerce' ); ?>"
				data-text-activate="<?php esc_attr_e( 'Activate', 'north-commerce' ); ?>"
			>
				<?php echo $button_text; ?>
			</a>
		</div>
	</div>

	<div class="service-item__body">
		<div class="service-item__title">
			<div class="title__wrapper">
				<h3>
					<?php echo esc_html( $integration_item['name'] ); ?>
				</h3>
			</div>
			<div class="loader"></div>
		</div>

		<p>
			<?php echo esc_html( $integration_item['description'] ); ?>
		</p>
	</div>
</div>
