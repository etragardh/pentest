<?php

defined( 'ABSPATH' ) || exit;

class North_Commerce_Orders {

	const OPTION_NAME = 'nc_orders_screen_option';
	const OPTION_DEFAULT = '10, 25, 50, 100';

    public static function init(){
	    add_action( 'load-north-commerce_page_north-commerce-orders', [get_class(), 'head']);
		add_filter( 'screen_settings', [get_class(), 'fields'], 10, 2 );
    }

    public static function head(){
		add_screen_option( self::OPTION_NAME, [
			'option'  => self::OPTION_NAME,
			'default' => self::OPTION_DEFAULT,
			'Label'   => __('Items per page', 'north-commerce'),
		] );
    }

    public static function fields($rv, $screen){
		if($screen->id !== 'north-commerce_page_north-commerce-orders') return $rv;

		if(!empty($_POST['nc_orders_screen_option']) && !empty($_POST[self::OPTION_NAME])){
			update_option(self::OPTION_NAME, $_POST[self::OPTION_NAME]);
			$val = sanitize_text_field($_POST['nc_orders_screen_option']);
		}else{
			$val = get_option(self::OPTION_NAME, self::OPTION_DEFAULT);
		}

		$rv .= '<fieldset class="screen-options">
					<legend>'.esc_html__('Number of order per page', 'north-commerce').'</legend>
					<label for="edit_page_per_page">'.esc_html__('Items per page:', 'north-commerce').'</label>
					<input type="text" class="screen-per-page" style="width:200px" id="'.self::OPTION_NAME.'" name="'.self::OPTION_NAME.'" value="'.$val.'">
				</fieldset>
				<p class="submit"><input type="submit" name="screen-options-apply" id="screen-options-apply" class="button button-primary" value="'.esc_html__('Apply', 'north-commerce').'"></p>
				';

        return $rv;
    }

}

North_Commerce_Orders::init();
