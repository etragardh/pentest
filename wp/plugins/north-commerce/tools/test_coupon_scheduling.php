<?php
/**
 * A PHP file for testing our Queueable in a sandbox environment.
 */

require_once(__DIR__ . '/wp_load.php');

( php_sapi_name() == 'cli' ) || die( "Must be run from the command line\n" );

parse_str( implode( '&', array_slice( $argv, 1 ) ), $args );

( $coupon_id = nc_g( $args, 'coupon_id' ) ) || die( "Specify a coupon id\n" );

$coupon_model = null; // TODO:refactor
$coupon = $coupon_model->get_by_id( $coupon_id );
$coupon_manager = NorthCommerce\Api\Coupon_Helper::instance();

$coupon_manager->schedule_status_change( $coupon );