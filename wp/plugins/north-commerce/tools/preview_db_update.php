<?php
/*
 * A PHP file for showing what SQL will be executed to perform a given update
 */
require_once(__DIR__ . '/wp_load.php');
(php_sapi_name() == 'cli') || die("Must be run from the command line\n");
parse_str(implode('&', array_slice($argv, 1)), $args);

($version = nc_g($args,'version')) || die("Must provide a version to preview\n");

$agent = North_Commerce_Db_Agent::instance();
$updater = $agent->updater();
$schema = $agent->schema();
$statements = $updater->updateSqlStatements($schema->getTablePrefix(), $version);

foreach($statements as $i => $stmt) {
	echo "-- Update " . ($i + 1) . "\n";
	echo $stmt . "\n\n";
}
