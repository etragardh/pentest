<?php
/*
 * A PHP file for being a base class for test fixtures. A text fixture is defined here:
 * https://docs.phpunit.de/en/9.5/fixtures.html
 *
 * It's the state needed to run a unit test.
 *
 * PHPunit has setUp and tearDown - why implement fixtures as separate entities? Because
 * as PHPunit explains, fixtures get complex and setUp is run for every method in the class.
 *
 * Using our own Fixture classes we can intelligently share, abstract and reuse fixtures:
 * https://docs.phpunit.de/en/9.5/fixtures.html#sharing-fixture
 */

namespace NorthCommerce\Testing;

use North_Commerce_Db_Entity_Access;

class Fixture
{

	/*
	 * Like PHPunit, we set stuff up here
	 */
	public function setUp()
	{
	}

	/*
	 * And tear things down
	 */
	public function tearDown()
	{
	}

	protected $ef;
	protected $ea;

	function __construct()
	{
		$this->ef = EntityFactory::instance();
		$this->ea = North_Commerce_Db_Entity_Access::instance();
	}

	/*
	* This is top level function that tests call to make use of Fixture.
	 */
	public static function use($code) {
		$fixture = new static();
		$fixture->setUp();
		try {
			$code($fixture);
		} finally {
			$fixture->tearDown();
		}
	}
}
