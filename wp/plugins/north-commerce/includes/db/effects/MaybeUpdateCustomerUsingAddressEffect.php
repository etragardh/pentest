<?php
/**
 * A PHP file for updating the customer info (name, phone, etc.).
 * Maybe. If the customer record has info, then don't do anything.
 * But, if the customer info needs this, then go for it.
 */


namespace NorthCommerce\Db\Effects;

class MaybeUpdateCustomerUsingAddressEffect extends PostEffect {

	protected static function behavior($address) {

		$customer = Effect::$ea->ref($address['customer_id']);

		$should_update = ! $customer['last_name']
			&& ! $customer['first_name']
			&& ! $customer['phone'];

		if ( $should_update ) {
			Effect::$ea->update('customers', $customer, [
				'first_name' => $address['first_name'],
				'last_name' => $address['last_name'],
				'phone' => $address['phone'],
			]);
		}

		return $address;

	}
}
