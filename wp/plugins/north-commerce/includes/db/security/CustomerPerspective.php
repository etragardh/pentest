<?php
/*
 * A PHP file for representing a customer's view of the database
 */

namespace NorthCommerce\Db\Security;

class CustomerPerspective extends Perspective {

	public function slug() {
		return 'customer';
	}

	public function	customizeSchema($tables)
	{
		unset($tables['products']['cols']['cost_of_goods_price']);
		unset($tables['products']['cols']['profit']);
		unset($tables['sequence_numbers']);

		$remove_from_sd = [
			'handling_fee', 'handling_percentage', 'shipping_cost'
		];
		foreach ( $remove_from_sd as $col ) {
			unset( $tables['shipping_details']['cols'][ $col ] );
		}

		return $tables;
	}

	public function appliesTo($wp_user) {
		return $wp_user && $wp_user->has_cap('read') && !$wp_user->has_cap('edit_pages');
	}
}
