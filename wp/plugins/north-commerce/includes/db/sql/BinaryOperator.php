<?php
/*
 * A PHP file for being a base class for all binary operators
 */
namespace NorthCommerce\Db\Sql;

use North_Commerce_Db_Agent;

/**
 * @since   0.1.3
 * @version 0.1.13
 */
class BinaryOperator extends Operator {

	private $lhs;
	private $rhs;

	function __construct( $op, $lhs, $rhs ) {
		parent::__construct($op);
		$this->lhs = $lhs;
		$this->rhs = $rhs;
	}

	/**
	 * @since   0.1.3
	 * @version 0.1.13
	 */
	public function toSql( $prefix = '' ) {
		if ( true === $prefix ) {
			$prefix = \NorthCommerce\Db\Schema::getTablePrefix();
		}

		$l_sql = $prefix . $this->lhs->toSql();
		$r_sql = $this->rhs->toSql();
		$op = strtoupper( $this->operator() );
		return "$l_sql $op $r_sql";
	}

	public function joins() {
		$joins = new Joins();
		$joins->add($this->lhs->joins());
		$joins->add($this->rhs->joins());
		return $joins;
	}

	public function lhs() {
		return $this->lhs;
	}

	public function rhs() {
		return $this->rhs;
	}

	public function	subExpressions()
	{
		return [$this->lhs, $this->rhs];
	}
}
