<?php
namespace NorthCommerce\Db\Coupons;

use NorthCommerce\Db\Collections\CouponStatuses as Statuses;

/**
 * Coupon Status requirement.
 *
 * @package north-commerce/includes/db/coupons
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.21
 * @version 0.1.21
 */
class Status_Requirement extends Requirement {

	protected $coupon_status_id;

	public function verify( array $coupon, Coupon_Criteria $criteria ) {
		$this->coupon_status_id = intval( $coupon['coupon_status_id'] );

		return $this->is_valid() ?: $this->error_message();
	}

	protected function is_valid(): bool {
		$published_id = (int) Statuses::published()->id;
		return  $published_id === $this->coupon_status_id;
	}

	protected function error_message(): string {
		return __( 'Unknown promo code. Please try another one.', 'north-commerce' );
	}

}
