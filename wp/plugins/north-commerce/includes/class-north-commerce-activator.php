<?php

use NorthCommerce\Db\Schema;

/**
 * Fired during plugin activation.
 *
 * This class defines all code necessary to run during the plugin's activation.
 *
 * @package north-commerce/includes
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.0
 */
class North_Commerce_Activator {

	/**
	 * @since 0.1.0
	 */
	public static function activate() {
        $token = openssl_random_pseudo_bytes(16);
        $token = bin2hex($token);
        update_option( 'stripe_token', $token);

		// Create Forms tabe
		North_Form_DB_Controller::create_table();

		// Install or update our master database schema.
		Schema::install();

		// Make sure permalinks can be set up on a fresh activation
		$permalinks = new North_Commerce_Permalinks();
		$permalinks->on_init();

		// Set up pre-built pages in the system
		$settings = new North_Commerce_Settings();
		$settings->maybe_create_pages();
		nc_wp_trace("maybe_create pages done");
	}

}
