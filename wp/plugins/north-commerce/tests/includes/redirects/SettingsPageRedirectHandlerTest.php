<?php
/*
 * A PHP file for testing out SettingsPageRedirectHandler
 */

use NorthCommerce\Redirects\SettingsPageRedirectHandler;

require_once(__DIR__ . '/../../north-commerce-test-case.php');

class SettingsPageRedirectHandlerTest extends North_Commerce_Test_case
{
	private SettingsPageRedirectHandler $h;

	public function testSlug()
	{
		$this->assertEquals('settings_page', $this->h->slug());
	}

	public function testHandleSuccess()
	{
		$url = $this->h->handle(['target' => 'checkout']);
		$this->assertStringStartsWith('http', $url);
		$this->assertEquals(North_Commerce_Settings::nc_get_page_url('checkout'),
							$url);
	}

	public function testHandleError()
	{
		$this->expectException(Exception::class);
		$this->h->handle(['target' => 'x-checkout']);
	}

	public function setUp(): void
	{
		parent::setUp();
		$this->h = new SettingsPageRedirectHandler();
	}
}
