<?php
/*
 * A PHP file for testing out StripeHelper
 */

use NorthCommerce\Services\StripeHelper;
use NorthCommerceStripe\StripeClient;

require_once(__DIR__ . '/../../north-commerce-test-case.php');

class StripeHelperTest extends North_Commerce_Test_case
{
	public function testStripeClient()
	{
		$sh = new StripeHelper();
		$sc = $sh->stripeClient();
		$this->assertInstanceOf(StripeClient::class, $sc);
	}

	public function testStripeCustomerFromCustomer()
	{
		$c = $this->ef->newCustomer();
		$sh = new StripeHelper();
		$s_c = $sh->stripeCustomerFromCustomer($c);
		$this->assertEquals($c['email'], $s_c->email);
	}

	public function testStripeCustomerFromCustomerExisting()
	{
		$c = $this->ef->newCustomer();
		$sh = new StripeHelper();
		$s_c1 = $sh->stripeCustomerFromCustomer($c);
		$s_c2 = $sh->stripeCustomerFromCustomer($c);
		$this->assertEquals($c['email'], $s_c1->email);
		$this->assertEquals($s_c1->id, $s_c2->id);
	}
}
