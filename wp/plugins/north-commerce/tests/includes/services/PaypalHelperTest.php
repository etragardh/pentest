<?php
/*
 * A PHP file for testing out PaypalHelper
 */

use NorthCommerce\Services\PaypalHelper;

require_once(__DIR__ . '/../../north-commerce-test-case.php');

class PaypalHelperTest extends North_Commerce_Test_case
{
	public function testInvokeApi()
	{
		$amount = 101.11;
		$ph = new PaypalHelper();

		$created = $ph->invokeApi([
			'method' => "POST",
			'path' => 'v2/checkout/orders',
			'body' => [
				'intent' => "AUTHORIZE",
				'purchase_units' => [
					['amount' =>  [
						'value' => $amount,
						'currency_code' => 'USD'
					]]
				]
			]
		]);
		$this->assertIsString($created['id']);

		$retrieved = $ph->invokeApi([
			'method' => "GET",
			'path' => "v2/checkout/orders/{$created['id']}"
		]);
		$this->assertEquals($amount, $retrieved['purchase_units'][0]['amount']['value']);

	}
}
