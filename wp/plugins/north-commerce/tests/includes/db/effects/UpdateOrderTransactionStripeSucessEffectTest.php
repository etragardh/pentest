<?php
/*
 * A PHP file for testing out UpdateOrderTransactionStripeSucessEffect
 */

use NorthCommerce\Db\Effects\UpdateOrderTransactionStripeSuccessEffect;
use NorthCommerce\Services\CustomerPaymentMethodStripeToken;

require_once(__DIR__ . '/../../../north-commerce-test-case.php');

class UpdateOrderTransactionStripeSucessEffectTest extends North_Commerce_Test_case
{
	public function testBehavior()
	{
		$ot = $this->ef->newOrderTransaction();
		$ot =$this->ef->excecuteStripeOrderTransaction($ot);
		$ot = UpdateOrderTransactionStripeSuccessEffect::run($ot);

		$cpm_after = $this->ea->ref($ot['customer_payment_method_id']);
		$this->assertEquals('visa', $cpm_after['brand']);
		$this->assertEquals('1111', $cpm_after['last4']);

	}
}
