<?php
/*
 * A PHP file for testing out our SQL Join construct
 */
require_once(__DIR__ . '/../../../north-commerce-test-case.php');

use NorthCommerce\Db\Sql\Join;

class JoinTest extends North_Commerce_Db_Test_Case
{

	public function testToSql()
	{
		$table_prefix = $this->tablePrefix();
		$j1 = (new Join("", "customer", "id",  "", "orders", "customer_id",true, false))->toSql();
		$this->assertEquals("JOIN {$table_prefix}orders orders ON (customer.id = orders.customer_id)", $j1);

		$j2 = (new Join("", "customers", "id",  "", "orders", "customer_id",false, false))->toSql();
		$this->assertEquals("LEFT OUTER JOIN {$table_prefix}orders orders ON (customers.id = orders.customer_id)", $j2);

		$j3 = (new Join("x_", "customers", "id", "y_", "orders", "customer_id", false, false))->toSql();
		$this->assertEquals("LEFT OUTER JOIN {$table_prefix}orders y_orders ON (x_customers.id = y_orders.customer_id)", $j3);


	}
}
