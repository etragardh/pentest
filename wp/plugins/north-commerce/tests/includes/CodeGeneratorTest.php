<?php
/*
 * A PHP file for testing out our Code Generator
 */

use NorthCommerce\CodeGenerator;

require_once(__DIR__ . '/../north-commerce-test-case.php');

class CodeGeneratorTest extends North_Commerce_Test_Case
{

	public function testBuild()
	{
		$gen = new CodeGenerator();
		$path = tempnam("/tmp", "db-collection-test");
		$t_name = 'payment_providers';
		$class_name = $this->agent->tableToClassName($t_name);
		$t_info = $this->agent->schema()->tableDefn($t_name);
		$gen->build('db_collection',$path, [
			'class_name' => $class_name,
			'table_name' => $t_name,
			'table_info' => $t_info
		], ['dest_dir' => ""]);

		$this->assertTrue(file_exists($path));
		$this->assertStringContainsString($class_name, file_get_contents($path));
	}

}
