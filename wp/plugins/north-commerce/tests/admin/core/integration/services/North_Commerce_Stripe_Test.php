<?php
/*
 * A PHP file for testing the North Commerce stripe wrapper
 */

use NorthCommerce\Testing\EntityFactory;

require_once(__DIR__ . '/../../../../north-commerce-test-case.php');

class North_Commerce_Stripe_Test extends North_Commerce_Test_Case {


	public function testCustomerLookup()
	{
		$ef = EntityFactory::instance();
		$c = $ef->newCustomer();
		$stripe = new North_Commerce_Stripe();
		$created = $stripe->lookup_customer($c);
		$this->assertStringContainsString("cus_", $created->id);
		$this->assertEquals($c['email'], $created->email);
		$this->assertEquals("{$c['first_name']} {$c['last_name']}", $created->name);

		$found = $stripe->lookup_customer($c);
		$this->assertEquals($created->id, $found->id);


	}
}
