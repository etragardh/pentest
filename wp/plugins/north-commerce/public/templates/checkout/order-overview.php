<?php

defined( 'ABSPATH' ) || exit;

use North_Commerce_Settings as Settings;

/**
 * Order overview
 *
 *
 * @package north-commerce/public/templates/checkout
 * @author  North Commerce <hello@northplugins.com>
 * @link    https://northcommerce.com/
 * @since   0.1.22
 * @version 0.1.22
 */


$settings       = new Settings();
$tax_percentage = (float) $settings->get_tax_percentage();
$currency_unit  = Settings::get_currency_symbol();
$tax_is_vat     = $settings->get_tax_is_vat() === 'enabled';

if ( ! function_exists( 'nc_checkout_display_cart_item' ) ) {
    function nc_checkout_display_cart_item() {
        $nc_template_loader = new North_Commerce_Template_Loader();
        $nc_template_loader->get_template_part('checkout/cart-item');
    }
}

add_action( 'nc_checkout_display_cart_item', 'nc_checkout_display_cart_item', 10 );

?>
<input type="checkbox" class="nc-order-review-collapsed" id="nc-order-review-collapsed" checked value="collapsed">
<div class="nc-order-review-container" data-type="nc-order-review-container">
    <div class="nc-order-review-header">
        <p class="nc-cart-title">
            <?php esc_html_e( 'In your cart', 'north-commerce' ); ?>
        </p>
        <label for="nc-order-review-collapsed" class="collapsed-content-handler collapsed-content-handler--open">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12.0002 15.7131L18.0102 9.70304L16.5972 8.28804L12.0002 12.8881L7.40423 8.28804L5.99023 9.70204L12.0002 15.7131Z" fill="black" />
            </svg>
        </label>
    </div>
    <div class="collapse-hidden-content">
        <div class="nc-line-items" data-type="nc-order-line-items">
        </div>
    </div>
    <hr class="nc-divider">
    <div class="nc-checkout-order-summary">
        <div class="nc-order-summary-totals nc-order-subtotal collapse-hidden-content">
            <p class="nc-order-summary-title">
                <?php esc_html_e( 'Subtotal', 'north-commerce' ); ?>
            </p>
            <p class="nc-order-summary-total-value">
                <span class="currency-unit"></span>
                <span class="nc-order-subtotal-value"></span>
            </p>
        </div>
        <div
            class="nc-order-summary-totals nc-order-tax collapse-hidden-content<?php echo $tax_is_vat ? ' tax-vat' : ' tax-standard', empty( $tax_percentage ) ? ' no-tax' : ''; ?>"
        >
            <input
                type="hidden"
                name="cart_tax_percentage"
                value="<?php echo $tax_percentage; ?>"
            >
            <p class="nc-order-summary-title">
                <?php echo $tax_is_vat ? 'VAT' : 'Tax' ?>
            </p>
            <div class="nc-order-totals-container">
                <?php
                if ( empty( $tax_percentage ) ) {
                    ?>
                    <p class="nc-order-summary-total-value">
                        <?php esc_html_e( 'Free', 'north-commerce' ); ?>
                    </p>
                    <p class="nc-order-tax-rate"></p>
                    <?php
                } else {
                    ?>
                    <p class="nc-order-summary-total-value">
                        <span class="currency-unit"></span>
                        <span class="nc-order-tax-value"></span>
                    </p>
                    <p class="nc-order-tax-rate"><?php echo $tax_percentage; ?>%</p>
                    <?php
                }
                ?>
            </div>
        </div>
        <div class="nc-order-summary-totals nc-order-summary-totals--hidden nc-order-shipping-fee collapse-hidden-content">
            <p class="nc-order-summary-title">
                <?php esc_html_e( 'Shipping & Handling', 'north-commerce' ); ?>
            </p>
            <p class="nc-order-summary-total-value">
                <?php echo Settings::formatted_price( 0 ); ?>
            </p>
        </div>

        <?php ( new North_Commerce_Template_Loader() )->get_template_part( 'promo-code' ); ?>

        <hr class="nc-divider collapse-hidden-content">

        <div class="nc-order-summary-totals nc-order-total ">
            <p class="nc-order-summary-title nc-bold collapse-hidden-content">
                <?php esc_html_e( 'Total to pay', 'north-commerce' ); ?>
            </p>
            <p class="nc-order-summary-total-value nc-bold">
                <span class="currency-unit"></span>
                <span class="nc-order-total-value"></span>
            </p>
            <label for="nc-order-review-collapsed" class="collapsed-content-handler collapsed-content-handler--closed">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12.0002 15.7131L18.0102 9.70304L16.5972 8.28804L12.0002 12.8881L7.40423 8.28804L5.99023 9.70204L12.0002 15.7131Z" fill="black" />
                </svg>
            </label>
        </div>

    </div>


</div>

<?php
do_action('nc_checkout_display_cart_item');
