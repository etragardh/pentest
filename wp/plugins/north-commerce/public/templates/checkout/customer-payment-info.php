<?php

/**
 * @version 0.1.24
 */

$paypal = new North_Commerce_Paypal();
$stripe = new North_Commerce_Stripe();
$currency_code = North_Commerce_Settings::get_currency_code();
$template = new NorthCommerce\Template_Manager( 'public' );

$paypal_enabled = $paypal->is_connected();
$stripe_enabled = $stripe->is_connected();

?>
<div
    class="nc-checkout-step-container"
    data-type="payment-info"
    data-currency-code="<?php echo $currency_code ?>"
>
    <input
        class="nc-checkout-set-edit-input"
        id="nc-3"
        name="nc-accordion"
        type="radio"
    >
    <div class="nc-checkout-step-header">
        <span class="nc-checkout-step">
            <?php esc_html_e( '03', 'north-commerce' ); ?>
        </span>
        <p class="nc-accordion-title">
            <?php esc_html_e( 'Payment', 'north-commerce' ); ?>
        </p>
    </div>
    <form class="nc-checkout-step-edit">
        <input
            type="hidden"
            name="nc_payment_service_paypal"
            id="nc_payment_service_paypal"
            value="<?php echo $paypal_enabled ? 'enabled' : 'disabled'; ?>"
        >
        <input
            type="hidden"
            name="nc_payment_service_stripe"
            id="nc_payment_service_stripe"
            value="<?php echo $stripe_enabled ? 'enabled' : 'disabled'; ?>"
        >

	    <?php do_action('north-commerce/checkout/payment-checkboxes') ?>

        <div class="nc-checkout-payment-services">
            <?php
            if ( $paypal_enabled ) {
                ?>
                <label class="nc-checkout-payment-service">
                    <div class="nc-checkout-payment-service-image">
                        <?php $template->use( 'ui/svg/paypal' ); ?>
                    </div>
                    <div class="nc-checkout-payment-service-name">
                        <?php esc_html_e( 'PayPal', 'north-commerce' ); ?>
                    </div>
                    <div class="nc-checkout-payment-service-select">
                        <input
                            type="radio"
                            name="nc-checkout-payment-service"
                            value="paypal"
                            id="nc-checkout-payment-service-paypal"
                            required
                        >
                        <label for="nc-checkout-payment-service-paypal">
                            <span></span>
                        </label>
                    </div>
                </label>
                <?php
            }

            if ( $stripe_enabled ) {
                ?>
                <label class="nc-checkout-payment-service">
                    <div class="nc-checkout-payment-service-image">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 4H4C2.897 4 2 4.897 2 6V18C2 19.103 2.897 20 4 20H20C21.103 20 22 19.103 22 18V6C22 4.897 21.103 4 20 4ZM5 8.5C5 8.224 5.224 8 5.5 8H8.5C8.776 8 9 8.224 9 8.5V10.5C9 10.776 8.776 11 8.5 11H5.5C5.224 11 5 10.776 5 10.5V8.5ZM11 16H5V14H11V16ZM19 16H13V14H19V16Z" fill="#FF5500" />
                        </svg>
                    </div>
                    <div class="nc-checkout-payment-service-name payment-service-name-stripe">
                        <?php esc_html_e( 'Card', 'north-commerce' ); ?>
                    </div>
                    <div class="nc-checkout-payment-service-select">
                        <input type="radio" required name="nc-checkout-payment-service" value="stripe" id="nc-checkout-payment-service-stripe">
                        <label for="nc-checkout-payment-service-stripe">
                            <span></span>
                        </label>
                    </div>
                </label>
                <?php
            }

            $mollie = new North_Commerce_Mollie();
            if (
                $mollie->is_connected()
                && ($mollie->is_test_mode() || North_Commerce_Admin::is_plugin_activated())
            ) {
                //			include 'template-form-mollie.php';
            }
            ?>

            <?php do_action('north-commerce/checkout/payment-services') ?>

        </div>

        <div class="nc-checkout-payments-forms">
            <?php
            if ( $paypal_enabled ) {
                ?>
                <div class="nc-checkout-payment-item" data-type="paypal">
					<div id="paypal-buttons"></div>
                </div>
                <?php
            }
            if ( $stripe_enabled ) {
                ?>
                <div class="nc-checkout-payment-item" data-type="stripe">
                    <input type="hidden" name="stripe_token" value="" id="stripe-token_input">
                    <div class="nc-checkout-stripe-payment-form">
						<div id="stripe-element"></div>
                    </div>
                    <div class="stripe-card-error"></div>
                </div>
                <?php
            }
            ?>

            <?php do_action('north-commerce/checkout/payment-forms') ?>
        </div>

        <div class="nc-customer-btn-container nc-payment-save-container">
            <button type="submit" class="nc-customer-checkout-btn nc-payment-save-btn">
                <?php esc_html_e( 'Save and continue', 'north-commerce' ); ?>
            </button>
        </div>
    </form>
    <div class="nc-checkout-set-edit-handler">
        <?php $template->use( 'ui/svg/pencil' ); ?>
    </div>
    <div class="nc-checkout-step-view hide">
        <div class="checkout-view-field" data-type="payment_service_paypal">
            <div class="checkout-view-field-icon">
                <?php $template->use( 'ui/svg/paypal' ); ?>
            </div>
            <div class="checkout-view-field-value">
                <?php esc_html_e( 'PayPal', 'north-commerce' ); ?>
            </div>
        </div>
        <div class="checkout-view-field" data-type="payment_service_stripe">
            <div class="checkout-view-field-icon">
                <svg width="24" class="stripe-payment-icon " height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 4H4C2.897 4 2 4.897 2 6V18C2 19.103 2.897 20 4 20H20C21.103 20 22 19.103 22 18V6C22 4.897 21.103 4 20 4ZM5 8.5C5 8.224 5.224 8 5.5 8H8.5C8.776 8 9 8.224 9 8.5V10.5C9 10.776 8.776 11 8.5 11H5.5C5.224 11 5 10.776 5 10.5V8.5ZM11 16H5V14H11V16ZM19 16H13V14H19V16Z" fill="#FF5500" />
                </svg>
            </div>
            <div class="checkout-view-field-value">
                <?php esc_html_e( 'Card', 'north-commerce' ); ?>
            </div>
        </div>

        <div class="checkout-view-field" data-type="billing_address_same_as_shipping">
            <div class="checkout-view-field-icon">
                <?php $template->use( 'ui/svg/payment-card' ); ?>
            </div>
            <div class="checkout-view-field-value">
                <?php esc_html_e( 'Use shipping address', 'north-commerce' ); ?>
            </div>
        </div>
        <div class="checkout-view-field" data-type="billing_full_name">
            <div class="checkout-view-field-icon">
                <?php $template->use( 'ui/svg/person' ); ?>
            </div>
            <div class="checkout-view-field-value">
            </div>
        </div>
        <div class="checkout-view-field" data-type="billing_address">
            <div class="checkout-view-field-icon">
                <?php $template->use( 'ui/svg/pin' ); ?>
            </div>
            <div class="checkout-view-field-value">
            </div>
        </div>
        <div class="checkout-view-field" data-type="billing_phone_number">
            <div class="checkout-view-field-icon">
                <?php $template->use( 'ui/svg/phone' ); ?>
            </div>
            <div class="checkout-view-field-value">
            </div>
        </div>
    </div>
</div>
