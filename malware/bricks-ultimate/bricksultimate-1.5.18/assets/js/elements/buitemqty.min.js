function buDropdownQty(){document.querySelectorAll(".brxe-bu-dd-qty").forEach(n=>{let c=n.querySelector(".bu-qty-dropdown")||!1,u=n.querySelector("a.trigger-qty")||!1;c&&(document.addEventListener("click",function(t){t=t.target;if(c.classList.contains("bu-qty-dd-opened")&&!jQuery(t).parents().is(".brxe-bu-dd-qty"))return qtyHideDropdown(c,u),!1}),u.addEventListener("click",toggleQtyDropdown),c.querySelectorAll("a").forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();let e=t.target,r=e.getAttribute("data-val"),a=e.innerText,o=e.closest(".bu-qty-list").querySelector(".current-item")||!1;if(o&&o.classList.remove("current-item"),e.closest("li").classList.add("current-item"),u.querySelector("span").innerText=a,qtyHideDropdown(c,u),"atc"==n.getAttribute("data-qty-action")&&""!=n.getAttribute("data-atc-selector")&&ddQtyUpdate(r,c,n.getAttribute("data-atc-selector")),"atc"!==n.getAttribute("data-qty-action")){let t=jQuery(n).closest(".woocommerce-mini-cart-item");t.block({message:null,overlayCSS:{opacity:.6}}),jQuery.ajax({url:woocommerce_params.ajax_url.toString(),type:"POST",data:{action:"buwoo_update_cart_item_quantity",cart_key:n.getAttribute("data-cart_item_key"),product_id:n.getAttribute("data-product_id"),qty:r,security:interactionParams.atc_nonce},dataType:"json",success:function(t){t.error||(jQuery(document.body).trigger("wc_fragment_refresh",[t.fragments,t.cart_hash,jQuery(e)]),document.dispatchEvent(new Event("bu_update_cart_quantity")))},complete:function(){t.unblock(),"yes"!==n.getAttribute("data-cartupdate")&&jQuery(document.body).trigger("wc_update_cart"),jQuery(document.body).trigger("update_checkout")}})}})}))})}function ddQtyUpdate(t,e,r=!1){e=e.closest(".brxe-loop-builder-on");e&&r&&(atcBtn=e.querySelector(r)||null)&&atcBtn.setAttribute("data-quantity",t)}function toggleQtyDropdown(t){t.preventDefault();const e=t.target.closest(".brxe-bu-dd-qty"),r=e.querySelector(".bu-qty-dropdown")||!1;return(r.classList.contains("bu-qty-dd-opened")?qtyHideDropdown:qtyShowDropdown)(r,this),!1}function qtyShowDropdown(t,e){t.classList.add("bu-qty-dd-opened"),e.classList.add("arrow-up")}function qtyHideDropdown(t,e){t.classList.remove("bu-qty-dd-opened"),e.classList.remove("arrow-up")}jQuery(document).ready(function(c){let u=1;c(document.body).on("focusin",".brxe-bu-cart-item-qty .qty",function(t){u=c(t.currentTarget).val()}),c(document.body).on("click tab touchstart",".brxe-bu-cart-item-qty .action",function(t){t.preventDefault();var e,r,t=c(t.currentTarget),a=t.siblings(".qty");a.length&&(e=u=parseFloat(a.val()),r=parseFloat(a.attr("step")),parseFloat(a.attr("min")),parseFloat(a.attr("max")),t=t.hasClass("plus")?e+r:e-r,a.val(t).trigger("change"))}),c(document.body).on("change",".brxe-bu-cart-item-qty .qty",function(t){if("undefined"==typeof woocommerce_params)return!1;t.preventDefault();var e=c(t.currentTarget),t=parseFloat(e.val()),r=parseFloat(e.attr("step")),a=parseFloat(e.attr("min")),o=parseFloat(e.attr("max")),n=!1;(n=!!(isNaN(t)||t<0||t<a||o<t||t%r!=0)||n)?e.val(u):(($row=e.closest(".woocommerce-mini-cart-item")).block({message:null,overlayCSS:{opacity:.6}}),c.ajax({url:woocommerce_params.ajax_url.toString(),type:"POST",data:{action:"buwoo_update_cart_item_quantity",cart_key:e.closest(".brxe-bu-cart-item-qty").attr("data-cart_item_key"),product_id:e.closest(".brxe-bu-cart-item-qty").attr("data-product_id"),qty:t,security:interactionParams.atc_nonce},dataType:"json",success:function(t){t.error?e.val(u):(c(document.body).trigger("wc_fragment_refresh",[t.fragments,t.cart_hash,e]),document.dispatchEvent(new Event("bu_update_cart_quantity")))},complete:function(){$row.unblock(),"yes"!==e.closest(".brxe-bu-cart-item-qty").attr("data-cartupdate")&&c(document.body).trigger("wc_update_cart"),c(document.body).trigger("update_checkout")}}))})}),document.addEventListener("DOMContentLoaded",function(){buDropdownQty(),window.buDropdownQty=buDropdownQty,window.WP_Grid_Builder&&WP_Grid_Builder.on("init",function(t){t.facets.on("appended",function(t){buDropdownQty()})})}),document.addEventListener("bricks/ajax/end",function(t){buDropdownQty()}),document.addEventListener("buAjaxSearchComplete",function(){buDropdownQty()}),document.addEventListener("bricks/ajax/query_result/displayed",function(t){buDropdownQty()}),document.addEventListener("buAfterGridTable",function(){setTimeout(()=>{buDropdownQty()},100)});