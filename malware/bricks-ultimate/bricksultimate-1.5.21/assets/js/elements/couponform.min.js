jQuery(document).ready(function(n){n(document.body).on("focusin",".bu-coupon-inp-field",function(){var e=n(this).attr("placeholder")||!1;e&&(n(this).attr("placeholder",""),n(this).attr("data-placeholder",e))}),n(document.body).on("focusout",".bu-coupon-inp-field",function(){var e=n(this).attr("data-placeholder")||!1;e&&n(this).attr("placeholder",e)}),document.querySelectorAll(".brxe-bu-coupons").forEach(e=>{!e.querySelector(".cart-discount")&&1&&e.classList.add("screen-reader-text")}),n(document.body).on("click",".apply-coupon-button",function(e){if(e.preventDefault(),"undefined"==typeof woocommerce_params)return!1;let o=n(e.currentTarget),c=o.closest(".brxe-bu-coupon-form"),t=c.find(".bu-coupon-inp-field"),r=t.val(),a=0;r&&(c.block({message:null,overlayCSS:{opacity:.35}}),e={security:c.attr("data-coupon-nonce"),coupon_code:r},n.ajax({type:"POST",url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","apply_coupon"),data:e,dataType:"html",success:function(e){c.unblock(),t.val(""),0<e.toString().search(/woocommerce-message/)&&window.sessionStorage.setItem("applied_coupon_"+r,"yes"),c.prepend(e),clearTimeout(a),a=setTimeout(()=>{c.find(".woocommerce-message").remove(),c.find(".woocommerce-error").remove()},2500),n(document.body).trigger("applied_coupon",[r]),bricksWooRefreshCartFragments(),"undefined"!=typeof wc_add_to_cart_params&&wc_add_to_cart_params.is_cart&&n(document.body).trigger("wc_update_cart"),(0<n(".woocommerce-checkout-review-order-table").length||0<n(".woocommerce-checkout-payment").length||0<n("#klarna-checkout-iframe").length)&&n(document.body).trigger("update_checkout")}}))}),n(document.body).on("click",".bu-remove-coupon",function(e){if(e.preventDefault(),"undefined"==typeof woocommerce_params)return!1;let o=n(e.currentTarget),c=o.closest(".brxe-bu-coupons"),t=o.attr("data-coupon");t&&(o.closest(".cart-discount").block({message:null,overlayCSS:{opacity:.35}}),n.ajax({type:"POST",url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","remove_coupon"),data:{security:COUPON.remove_coupon_nonce,coupon:t},dataType:"html",success:function(e){o.closest(".cart-discount").unblock().remove(),o.closest(".cart-discount").length<0&&c.addClass("screen-reader-text"),window.sessionStorage.removeItem("applied_coupon_"+t),n(document.body).trigger("removed_coupon",[t]),bricksWooRefreshCartFragments(),"undefined"!=typeof wc_add_to_cart_params&&wc_add_to_cart_params.is_cart&&n(document.body).trigger("wc_update_cart"),(0<n(".woocommerce-checkout-review-order-table").length||0<n(".woocommerce-checkout-payment").length||0<n("#klarna-checkout-iframe").length)&&n(document.body).trigger("update_checkout")}}))}),n(document.body).on("applied_coupon removed_coupon applied_coupon_in_checkout removed_coupon_in_checkout",function(e,o){void 0!==o&&n.ajax({type:"POST",url:woocommerce_params.ajax_url.toString(),data:{action:"bu_applied_coupon",security:COUPON.nonce},dataType:"html",success:function(o){document.querySelectorAll(".brxe-bu-coupons").forEach(e=>{e.classList.remove("screen-reader-text"),e.innerHTML=o.replace(/Discount/g,COUPON.i18n_discount).replace(/Remove/g,COUPON.i18n_remove).replace(/Free shipping coupon/g,COUPON.i18n_fstext),""!=o&&null!=o||e.classList.add("screen-reader-text")})}})}),n(document.body).on("added_to_cart removed_from_cart",function(){n.ajax({type:"POST",url:woocommerce_params.ajax_url.toString(),data:{action:"bu_applied_coupon",security:COUPON.nonce},dataType:"html",success:function(o){document.querySelectorAll(".brxe-bu-coupons").forEach(e=>{e.classList.remove("screen-reader-text"),e.innerHTML=o.replace(/Discount/g,COUPON.i18n_discount).replace(/Remove/g,COUPON.i18n_remove).replace(/Free shipping coupon/g,COUPON.i18n_fstext),""!=o&&null!=o||e.classList.add("screen-reader-text")})}})})});